---
format:
  fundar-revealjs: default

title: La cocina de
subtitle: <a href="https://argendata.fund.ar"><picture><source srcset="./argendata-logo-b.svg"><img src="argendata.fund.ar" width="700"></img></picture></a>

authors: 
  - name: Juan Pablo Ruiz Nicolini
    acknowledgements: <a>\@tuqmano</a>
    affiliation: Coordinador del Área de Datos
    email: jpruiznicolini@fund.ar

  - name: Joan Imanol Gonzalez Quiroga
    affiliation: Científico de datos
    email: jigonzalezquiroga@fund.ar

---

## Hoja de ruta
<!-- Barra superior negra  -->
<div class="top-bar">
  <div class="left"></div>
  <div class="center">
  <div class="left-text">Hoja de ruta</div>
  <div class="logo">
  <img src="./_extensions/fundar/logo_fundar-light.svg"/>
  </div></div><div class="right"></div>
</div>

## Sobre Fundar
<!-- Barra superior negra  -->
<div class="top-bar">
  <div class="left"></div>
  <div class="center">
  <div class="left-text">Sobre Fundar</div>
  <div class="logo">
  <img src="./_extensions/fundar/logo_fundar-light.svg"/>
  </div></div><div class="right"></div>
</div>

## Datos Fundar
<!-- Barra superior negra  -->
<div class="top-bar">
  <div class="left"></div>
  <div class="center">
  <div class="left-text">Datos Fundar</div>
  <div class="logo">
  <img src="./_extensions/fundar/logo_fundar-light.svg"/>
  </div></div><div class="right"></div>
</div>

## Argendata
<!-- Barra superior negra  -->
<div class="top-bar">
  <div class="left"></div>
  <div class="center">
  <div class="left-text">Argendata</div>
  <div class="logo">
  <img src="./_extensions/fundar/logo_fundar-light.svg"/>
  </div></div><div class="right"></div>
</div>

## GitHub Argendata
<!-- Barra superior negra  -->
<div class="top-bar">
  <div class="left"></div>
  <div class="center">
  <div class="left-text">GitHub Argendata</div>
  <div class="logo">
  <img src="./_extensions/fundar/logo_fundar-light.svg"/>
  </div></div><div class="right"></div>
</div>

<div align='center'>
<a href="https://github.com/argendatafundar">
<picture>
<source srcset="captura.png">
<img src="captura.png" width="1500"></img>
</picture>
</a>
</div>

## Workflow
<!-- Barra superior negra  -->
<div class="top-bar">
  <div class="left"></div>
  <div class="center">
  <div class="left-text"><em>Workflow</em></div>
  <div class="logo">
  <img src="./_extensions/fundar/logo_fundar-light.svg"/>
  </div></div><div class="right"></div>
</div>

<div align='center'>
<picture>
<source srcset="simple.svg">
<img src="captura.png" width="1500"></img>
</picture>
</div>

## Workflow... más granular
<!-- Barra superior negra  -->
<div class="top-bar">
  <div class="left"></div>
  <div class="center">
  <div class="left-text"><em>Workflow</em>... más granular</div>
  <div class="logo">
  <img src="./_extensions/fundar/logo_fundar-light.svg"/>
  </div></div><div class="right"></div>
</div>

<div align='center'>
<picture>
<source srcset="complejo.svg">
<img src="captura.png" width="1500"></img>
</picture>
</div>

## ¡Datos abiertos!
<!-- Barra superior negra  -->
<div class="top-bar">
  <div class="left"></div>
  <div class="center">
  <div class="left-text">¡Datos abiertos!</div>
  <div class="logo">
  <img src="./_extensions/fundar/logo_fundar-light.svg"/>
  </div></div><div class="right"></div>
</div>

<div align='center'>
<picture>
<source srcset="repo-data.png">
<img src="captura.png" width="1700"></img>
</picture>
</div>

## Controles de calidad
<!-- Barra superior negra  -->
<div class="top-bar">
  <div class="left"></div>
  <div class="center">
  <div class="left-text">Controles de calidad</div>
  <div class="logo">
  <img src="./_extensions/fundar/logo_fundar-light.svg"/>
  </div></div><div class="right"></div>
</div>

- Los datos son recolectados según lo hicieron lxs investigadorxs,
- automatizado a través de scripts en _**R**_ (más sobre eso después!)
- Son ~300 fuentes de +100 instituciones distintas.
- Procesadas por distintas personas, que trabajan con distintos conocimientos y herramientas.

¿Cómo hicimos para asegurar la calidad de los datos?

<img src="sankey-variabilidad-datos-entrada.png" width="1800"></img>

## Controles de calidad - Algunos problemas
<!-- Barra superior negra  -->
<div class="top-bar">
  <div class="left"></div>
  <div class="center">
  <div class="left-text">Controles de calidad - Algunos problemas</div>
  <div class="logo">
  <img src="./_extensions/fundar/logo_fundar-light.svg"/>
  </div></div><div class="right"></div>
</div>

- Formatos de entrada
  - Variabilidad en el tipo de archivo (csv, tsv, pdf, estáticos).
  - Variabilidad en el formato CSV (separador, _line terminator_, quoting, punto/coma decimal)
- Almacenamiento
  - Google Drive
- Control de cambios (versiones)
  - GitHub
- Encoding
  - ["Estándares"](./xkcd-standards.png)
  - UTF-8, UTF-8-BOM, `chardet` y compañía.
  - Caracteres invisibles
  - Re-encoding
- Nomenclatura de fuentes
- Nomenclatura de regiones geográficas

## Controles de calidad - Verificadores
<!-- Barra superior negra  -->
<div class="top-bar">
  <div class="left"></div>
  <div class="center">
  <div class="left-text">Controles de calidad - Verificadores</div>
  <div class="logo">
  <img src="./_extensions/fundar/logo_fundar-light.svg"/>
  </div></div><div class="right"></div>
</div>

Verificaciones _paralelas_ + resumen

::: {layout-ncol="2"}

```python
import unittest

class TestStringMethods(unittest.TestCase):

    def test_upper(self):
        self.assertEqual('foo'.upper(), 'FOO')

    def test_isupper(self):
        self.assertTrue('FOO'.isupper())
        self.assertFalse('Foo'.isupper())

    def test_split(self):
        s = 'hello world'
        self.assertEqual(s.split(), ['hello', 'world'])
        with self.assertRaises(TypeError):
            s.split(2)

    def test_fail(self):
      s = 'hello world'
      splitted = s.split()
      self.assertEqual(len(splitted), 3)


```

```java
test_fail (a.TestStringMethods.test_fail) ... FAIL
test_isupper (a.TestStringMethods.test_isupper) ... ok
test_split (a.TestStringMethods.test_split) ... ok
test_upper (a.TestStringMethods.test_upper) ... ok

========================================================
FAIL: test_fail (a.TestStringMethods.test_fail)
--------------------------------------------------------
Traceback (most recent call last):
  File "test.py", line 21, in test_fail
    self.assertEqual(len(splitted), 3)
AssertionError: 2 != 3

--------------------------------------------------------
Ran 4 tests in 0.001s

FAILED (failures=1)
```

:::

## Controles de calidad - Verificadores 
<!-- Barra superior negra  -->
<div class="top-bar">
  <div class="left"></div>
  <div class="center">
  <div class="left-text">Controles de calidad - Verificadores</div>
  <div class="logo">
  <img src="./_extensions/fundar/logo_fundar-light.svg"/>
  </div></div><div class="right"></div>
</div>

Verificaciones _secuenciales_ + resumen

::: {layout-ncol="2"}


```python
from argendata.qa import Verifica

@Verifica["Archivo"]
class ControlCSV:
    a_verificar: str

    def __init__(self, path: str):
        self.a_verificar = path

    def verificacion_encoding(self, a_verificar: str):
        codecs = get_codecs(a_verificar)
        if len(codecs) > 0:
            self.codec = codecs[0][0]
        else:
            self.log.debug(...)
            self.codec = use_chardet(a_verificar)

        if self.codec is None:
            self.codec = 'utf-8'
        return self.codec
```

<img src="qa-tranen.png" width="800"></img>


:::

## Controles de calidad - Verificadores
<!-- Barra superior negra  -->
<div class="top-bar">
  <div class="left"></div>
  <div class="center">
  <div class="left-text">Controles de calidad - Verificadores</div>
  <div class="logo">
  <img src="./_extensions/fundar/logo_fundar-light.svg"/>
  </div></div><div class="right"></div>
</div>

Las verificaciones se pueden _combinar_ de manera paralela, pero cada verificación sigue su _hilo_ secuencial. Finalmente todas confluyen hacia un resultado final a ser graficado como PDF.

<img src="verif-parallel.png" width="1300"></img>

## Controles de calidad - Verificadores
<!-- Barra superior negra  -->
<div class="top-bar">
  <div class="left"></div>
  <div class="center">
  <div class="left-text">Controles de calidad - Verificadores</div>
  <div class="logo">
  <img src="./_extensions/fundar/logo_fundar-light.svg"/>
  </div></div><div class="right"></div>
</div>

